var app = angular.module("HydromertaDesktop", ["leaflet-directive","geolocation"]);
var colors = ["green","red","orange"];
var mapboxMapId =  "hydromerta.lpkj6fe5";
var mapboxAccessToken = "pk.eyJ1IjoiaHlkcm9tZXJ0YSIsImEiOiJZTUlDdVA0In0.Z7qJF3weLg5WuPpzt6fMdA"
var mapboxTileLayer = "http://api.tiles.mapbox.com/v4/" + mapboxMapId;
    mapboxTileLayer = mapboxTileLayer + "/{z}/{x}/{y}.png?access_token=" + mapboxAccessToken;

app.controller("MapController", function ($scope, leafletData,geolocation) {
	
	var getColor = function(id){
            return id == 'USA'? 'blue' : 'green';
        };

    var getStyle = function(feature){
        return {
            fillColor: getColor(feature.id),
            weight: 2,
            opacity: 1,
            color: 'white',
            dashArray: '3',
            fillOpacity: 0.7
        };
    };

	angular.extend($scope, {
	    defaults: {
	        maxZoom: 15,
	        tileLayer: mapboxTileLayer,
	        tileLayerOptions: {
            detectRetina: true,
	            reuseTiles: true,
	            attribution: '<a href="http://osm.org">OpenStreetMaps</a>'
	        }
	    },
	    mapCenter: {
	            lat: 46.76,
	            lng: 6.65,
	            zoom: 14
	          },
	   
	    markers :{
	    },
	    paths:{	    
	    },
	    layers: {
	    	overlays: {
                wms: {
                    name: 'EEUU States (WMS)',
                    type: 'wms',
                    visible: true,
                    url: 'http://suite.opengeo.org/geoserver/usa/wms',
                    layerParams: {
                        layers: 'usa:states',
                        format: 'image/png',
                        transparent: true
                    }
                },
                cars: {
                    name: 'Cars',
                    type: 'group',
                    visible: true
                }
            },
                    
		    baselayers: {
		        googleTerrain: {
		             name: 'OpenStreetMap',
                    url: 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
                    type: 'xyz'
		        }
			}
		},
		addSectorLabels: function(sectors){
			leafletData.getMap("map").then(function(map){
				leafletData.getPaths().then(function(paths){
					for (var i = sectors.length - 1; i >= 0; i--) {
						var title = sectors[i].properties.nomsquart;
						var sector = paths["sector"+i];
						//var center = paths["sector"+i].getBounds().getCenter();
						console.log(sector)
						var labelLocation = new L.LatLng(51.329219337279405, 10.454119349999928);
					};
					var labelTitle = new L.LabelOverlay(labelLocation, '<b>'+title+'</b>');
					map.addLayer(labelTitle);
				})
				
			});	
		},
   		addSectorMarkersToMap: function(sectors){
			var sectorPoints = [];
			var indexPoint= 0;
			for (var i = sectors.length - 1; i >= 0; i--) {
				indexPoint = indexPoint+ sectors[i].properties.ActionPoints.length;
			};

			for (var i = sectors.length - 1; i >= 0; i--) {
				
				for (var j = sectors[i].properties.ActionPoints.length - 1; j >= 0; j--) {
					var marker = {};
					var point = sectors[i].properties.ActionPoints[j];
					var lng = point.geometry.coordinates[0];
					var lat = point.geometry.coordinates[1];

					marker.lat = lat;
					marker.lng = lng;
					marker.group = 'sector'+i;
					marker.name = point.properties.type;

					if (point.properties.type=="Player") {
						marker.icon = playerIcon;
					}else{
						marker.icon = markerIcon
					}if (point.properties.type=="Fontaine") {
						marker.icon = fontaineIcon
					};
					var text = "cercle "+indexPoint+ " //"+ point.properties.type + " appartient Ã  "+ sectors[i].properties.nomsquart + " radius "+ point.properties.actionRadius
					marker.message = text;
					sectorPoints.push(marker)
					indexPoint--;
				};
				
			};

			return sectorPoints;
		},
   		addPointRadiusToMap: function(sectors){
   			var shapes = {};
   			var circles = {};
   			var polygons = {}
			//get total number of points to draw the circles
			var totalCircles= 0;
			for (var i = sectors.length - 1; i >= 0; i--) {
				totalCircles = totalCircles+ sectors[i].properties.ActionPoints.length;
			};
			// set the sectors
			//message label??
			//mouseover, events??
			//geojson same?? style individuel??
			//label a part??
			//colors change 
			for (var i = sectors.length - 1; i >= 0; i--) {

	   				var sector = {};
	   				var latlngs = [];
	   				sector.latlngs = [];
	   				sector.type = "polygon";
	   				sector.weight = 3;	
	   				sector.actionsPolygon = sectors[i].properties.actionsPolygon
	   				sector.actionPoints = sectors[i].properties.ActionPoints
	   				sector.message = "<h3>Influence : "+sectors[i].properties.influence+"%</h3><p>Boss: "
	   					+sectors[i].properties.character.name+"</p>",

	   				latlngs = sectors[i].geometry.coordinates[0]
	   				//set all the coordinates
	   				for (var x = latlngs.length - 1; x>= 0; x--) {
	   					sector.latlngs[x] = {
	   						lat: latlngs[x][1], lng: latlngs[x][0]
		   				}
	   				};
	   				if (sectors[i].properties.influence >50) {
	   					sector.color = "orange";
	   					sector.fillColor  = "orange";

	   					
	   				}else if(sectors[i].properties.influence<50){
	   					sector.color = "green"
	   				};			
	   				
	   				shapes["sector"+i] = sector;

	   			//set the circle radius
				for (var j = sectors[i].properties.ActionPoints.length - 1; j >= 0; j--) {
					var circle = {};
					var point = sectors[i].properties.ActionPoints[j];
					var lng = point.geometry.coordinates[0];
					var lat = point.geometry.coordinates[1];

					circle.type = "circle";
					circle.pointerEvents = "none";
					circle.radius = point.properties.actionRadius;
					circle.latlngs = {
						lat : lat, 
						lng: lng
					}
					circle.color = '#f357a1';
					circle.weight = 2;
		           
					shapes["circle"+totalCircles] = circle;

					totalCircles--;

				};

			};

			return shapes;
   		},
   		isMarkerInCircles:function(marker, sectors, circles){
   			var isIn = [];
   			var totalCircles = 0;
			var isInCircle = false;
			//total circles
			for (var i = sectors.length - 1; i >= 0; i--) {
				totalCircles = totalCircles+ sectors[i].properties.ActionPoints.length;
			};
			// check what circles is the marker in
			for (var i = 1; i < totalCircles; i++) {
				isInCircle = geolib.isPointInCircle(
					{latitude: marker.lat, longitude: marker.lng},
					{latitude: circles["circle"+i].latlngs.lat, longitude:circles["circle"+i].latlngs.lng},
					circles["circle"+i].radius
				);
				if (isInCircle) {
					isIn.push(i);
				}				
			};
			return isIn;
   		},
   		changeMarkerColor: function(color){
   			if(color == 'green'){
				return 'red';
			}if(color=="red"){
				return 'orange'
			}if (color=="orange") {
				return "green";
			};
   		},
   		addSectorsToMap: function(sectors){
	   			var theSectors = {};
	   			
	   			for (var i = sectors.length - 1; i >= 1; i--) {
	   				var sector = {};
	   				var latlngs = [];
	   				console.log(i)
	   				sector.type = "polygon";
	   				sector.name = sectors[i].properties.nomsquart;
	   				console.log(latlngs)
	   				latlngs = sectors[i].geometry.coordinates[0]				
	   				sector.latlngs = latlngs
	   				theSectors["sector"+i] = sector;
	   			};
	   			console.log(theSectors)
	   			return theSectors;		
   		},
   		setPlayerPosition:function(){
   			geolocation.getLocation().then(function(data){
		      $scope.coords = {lat:data.coords.latitude, long:data.coords.longitude};
	   					var player  = {"type":"Feature","geometry":{"type":"Point","coordinates":[0,0]},"properties":{"actionRadius":1,"type":"Player"}}
	   					player.lat = $scope.coords.lat;
	   				    player.lng = $scope.coords.long;
	   				    player.icon = playerIcon;
	   				    $scope.markers.push(player);
		    });   			
   		},
   		getPlayer:function(){
   			for (var i = $scope.markers.length - 1; i >= 0; i--) {
	   				if ($scope.markers[i].name == "Player"){
	   					return $scope.markers[i]
	   				}
   				};
   		},
   		getSectorActions:function(name){
   			console.log($scope.paths[name].actionsPolygon)
   		},
   		isMarkerInSector:function(player,sectors){
   			for (var i = sectors.length - 1; i >= 0; i--) {

   			};
   		}

	});

	$scope.markers = $scope.addSectorMarkersToMap(sectors);
	$scope.paths = $scope.addPointRadiusToMap(sectors, $scope);
	$scope.setPlayerPosition();
	$scope.addSectorLabels(sectors);
	////DIRECTIVES////

		// MARKER CLICK
		 $scope.$on('leafletDirectiveMarker.click', function(ev, featureSelected, leafletEvent) {
		 			var markerIndex = featureSelected.markerName;
		 			var player = $scope.markers[markerIndex];
		 			var circleIds = $scope.isMarkerInCircles(player, sectors, $scope.paths);
		 			var sectorId = $scope.isMarkerInSector($scope.markers[0], sectors);
		 			//$scope.getSectorActions(circleIds)
	    });
		//MARKER MOUSEOVER
		$scope.$on('leafletDirectiveMarker.mouseover', function(ev, featureSelected, leafletEvent) {
					featureSelected.leafletEvent.target.openPopup();
		});
		//MARKER MOUSEOUT
		$scope.$on('leafletDirectiveMarker.mouseout', function(ev, featureSelected, leafletEvent) {
					featureSelected.leafletEvent.target.closePopup();
		});
		//MOUSE CLICK
		$scope.$on("leafletDirectiveMap.click", function(ev, featureSelected, leafletEvent) {
		       // isClickInCircle(featureSelected.leafletEvent.latlng, $scope.geojson.data, $scope.paths )    
	    });
	    //SECTOR CLICK
	    $scope.$on('leafletDirectivePath.mousedown',function(ev, featureSelected, leafletEvent){
	    	var sectorName = featureSelected.pathName;
	    	$scope.getSectorActions(sectorName);
	    })

  


	
	console.log($scope)

})// MAP CONTROLLER

//////EXEMPLE

		
		//the points
		var points = [{"type":"Feature","geometry":{"type":"Point","coordinates":[6.65115741132304,46.7662704958143]},"properties":{"type":"Arrosage","actionRadius":50}}
			,{"type":"Feature","geometry":{"type":"Point","coordinates":[6.64429744113523,46.7660469106743]},

			"properties":{"actionRadius":100,"type":"Fontaine","genre_resolved":"Fontaine","type_resolved":"potable","etat_resolved":"en service"}}
			,{"type":"Feature","geometry":{"type":"Point","coordinates":[6.64081674754187,46.7644334136059]},

			"properties":{"actionRadius":1220,"type":"Fontaine","genre_resolved":"Fontaine","type_resolved":"potable","etat_resolved":"en service"}}]

		var points2  = [{"type":"Feature","geometry":{"type":"Point","coordinates":[6.61876200862168,46.776154891159]},
			"properties":{"actionRadius":380,"type":"WC",}}

			,{"type":"Feature","geometry":{"type":"Point","coordinates":[6.6295594892296,46.7747629606645]},
			"properties":{"actionRadius":700,"type":"WC"}}]

		//the sector with its action points and action zone
		var secteur = {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[6.62819299886849,46.7915241928172],[6.62819299945374,46.7915241929871],[6.62830402441461,46.7916229473289],[6.62829178800131,46.7916788147764],[6.62840143452275,46.7917734209063],[6.62850858433616,46.7918504799474],[6.62854280080062,46.7918750873034],[6.6286730667118,46.7919551193768],[6.62869153004325,46.7919664627017],[6.62945953364062,46.7923890527477],[6.62947295479279,46.7923762837741],[6.6294914827642,46.792346188896],[6.6294914859067,46.7923461903198],[6.6295265930777,46.7922849079311],[6.62954399020371,46.7922429304788],[6.62955540475707,46.7922242097176],[6.62945660973497,46.7921655753142],[6.6295226047822,46.7920535943923],[6.629586685496,46.7919469971886],[6.63050173601766,46.7905326672508],[6.63080371742601,46.790326730886],[6.63168633003087,46.7889579508009],[6.63172049918652,46.7888802880709],[6.63310489666639,46.7867881751044],[6.6334357358445,46.7862882684241],[6.63372811407811,46.7858463833607],[6.63381839064696,46.7857035352761],[6.63389174364348,46.7855888150554],[6.63398260670426,46.7854504689401],[6.63422797384614,46.7850865156137],[6.63433605595348,46.7849262505277],[6.63457275845297,46.7845458627347],[6.63472035842517,46.7843087807268],[6.63532043110814,46.7837868906667],[6.63524411893224,46.7837431515024],[6.63511026223282,46.7836664307749],[6.6351081861956,46.7836677295203],[6.63510604609229,46.7836689827908],[6.63510382860634,46.7836701723734],[6.63510155823539,46.783671317109],[6.63509923765585,46.7836723983481],[6.63509685155107,46.7836734247679],[6.63509442788613,46.7836743971144],[6.63509193895006,46.7836752976224],[6.63508941167097,46.7836761429534],[6.63508684695468,46.783676925976],[6.6350842296403,46.7836776449362],[6.63508158768469,46.7836783011291],[6.63507890764016,46.7836788851258],[6.63507620123302,46.783679414579],[6.63507347125438,46.7836798631532],[6.63507071490494,46.783680257733],[6.63506794698075,46.7836805709691],[6.63506515362433,46.7836808208833],[6.6350623612023,46.7836810082103],[6.6350595570662,46.7836811235268],[6.63505674121606,46.783681166833],[6.63505392550931,46.7836811469974],[6.63505112446328,46.783681055337],[6.63504832449923,46.7836808912074],[6.63504553838851,46.7836806557965],[6.63504275322043,46.7836803572494],[6.63503999536159,46.783679996301],[6.63503725137251,46.7836795629733],[6.63503454841903,46.7836790580067],[6.63503185918776,46.7836784905431],[6.63502919727398,46.7836778601291],[6.63502657479735,46.7836771580651],[6.63502399322519,46.7836763931464],[6.63502145161891,46.7836755747005],[6.63501896384426,46.783674684157],[6.63501651602732,46.7836737406354],[6.63501412124274,46.7836727250104],[6.63501176708401,46.7836716651971],[6.63500949220125,46.7836705422504],[6.63500725741561,46.7836693569925],[6.63500510161907,46.7836681278166],[6.63500299939187,46.7836668441113],[6.63447017626879,46.7833300604033],[6.63446781567673,46.7833285233935],[6.63446553408199,46.7833269419171],[6.63446333254624,46.7833252984113],[6.63446121001599,46.7833236098899],[6.63445916647483,46.7833218774508],[6.63445720286962,46.7833200912175],[6.63445534449688,46.7833182700367],[6.63445355153449,46.7833164042935],[6.63445186461196,46.7833145030593],[6.63445026946619,46.7833125579977],[6.63444875412512,46.7833105679261],[6.63444734401645,46.783308542907],[6.63444602542203,46.7833064916287],[6.63444481286743,46.7833044048595],[6.63444370447529,46.7833023012545],[6.63444268933527,46.7833001620685],[6.63444179115357,46.7832980055878],[6.63444099874096,46.7832958317336],[6.63444029850233,46.783293640959],[6.6344397160212,46.7832914328953],[6.6342766936782,46.7832548394984],[6.63437575371258,46.7831547835371],[6.6345169046484,46.7830160722669],[6.63456236569785,46.7829710529321],[6.63462975241821,46.7829046882863],[6.63466204699146,46.7828731605881],[6.63477011183799,46.7827663307682],[6.63483751416465,46.7826988866449],[6.63484072065998,46.7826955357691],[6.63484225352927,46.7826937291571],[6.63484369568081,46.7826918955506],[6.63484504567193,46.7826900245071],[6.63484630494531,46.7826881264692],[6.63484747364856,46.7826861915545],[6.63484855057252,46.782684247208],[6.6348495361271,46.7826822659793],[6.63485041725428,46.7826802658954],[6.63485120660216,46.7826782563797],[6.63485190444135,46.7826762193149],[6.63485249851299,46.7826741727338],[6.6348530008136,46.7826721161718],[6.63485339868684,46.7826700407548],[6.63485369106294,46.7826679645944],[6.63485384131315,46.7826658248388],[6.63485389886202,46.7826636838809],[6.63485383971649,46.7826615426497],[6.63485368786141,46.7826594007653],[6.63485341918901,46.7826572668428],[6.6348530576759,46.7826551410512],[6.63485259132558,46.782653023855],[6.63485202094549,46.7826509147108],[6.63485135758539,46.7826488230306],[6.63485059006434,46.7826467481867],[6.63484971676755,46.7826446912656],[6.63484873930986,46.7826426511808],[6.63484768232775,46.7826406374398],[6.63484650745043,46.7826386503214],[6.63484525304868,46.782636689547],[6.63484389341633,46.7826347637205],[6.63484245505879,46.7826328642434],[6.63484091146242,46.7826310002632],[6.63483928900151,46.7826291719658],[6.63483757409754,46.7826273787062],[6.6348357794068,46.7826256293589],[6.63483389292465,46.7826239249374],[6.63483192757798,46.7826222561985],[6.6348298823134,46.7826206401559],[6.6348277580449,46.7826190691293],[6.63482556743705,46.7826175514437],[6.6348232978417,46.7826160776759],[6.63482096189057,46.7826146583473],[6.6348185594771,46.7826133005948],[6.63481609084726,46.7826119879483],[6.63481355574685,46.7826107374271],[6.63432190569908,46.7823851623813],[6.63420940273909,46.7823332722584],[6.63392546601587,46.7822033477362],[6.63353119158024,46.7820257747952],[6.63338940568208,46.7819618024744],[6.63303312732947,46.7818006885662],[6.63268101844624,46.7816411321416],[6.63267138141755,46.7816367011561],[6.63254549606424,46.7815788222122],[6.63222212757116,46.7814328718428],[6.6319498902346,46.7813093217457],[6.63173787654368,46.7812130953154],[6.63171065118038,46.781203456555],[6.63168238452901,46.7812021771177],[6.63165450785036,46.7812098063133],[6.63163256221448,46.7812235951785],[6.63150060877465,46.7811592398024],[6.63167504172691,46.7810106020576],[6.63168950604082,46.7809979303219],[6.63183039804292,46.7808765820225],[6.63184538440643,46.7808640040071],[6.63187814813702,46.7808360784459],[6.63190414156,46.7808143122042],[6.63191860496807,46.7808016404335],[6.63200203412589,46.7807309823107],[6.6320267000505,46.7807103761683],[6.63203227610722,46.7807052884038],[6.63204820601498,46.7806909171899],[6.63214594953768,46.7806087561846],[6.63216996351313,46.7805879653077],[6.63226705482583,46.7805056194947],[6.63231057046276,46.7804680540653],[6.63242890221969,46.7803664267539],[6.63244137214991,46.7803557196684],[6.63247360775043,46.7803280603475],[6.63258384678056,46.780233392768],[6.6325926028535,46.7802258077765],[6.63266596297633,46.7801628149361],[6.63264764570288,46.7801529702968],[6.63292645795689,46.7799157381394],[6.63299782865458,46.7798543502373],[6.63300092017266,46.7798516821897],[6.63300393310585,46.7798489778975],[6.63300685480701,46.7798462279374],[6.63300969887039,46.7798434318562],[6.63301245235301,46.7798405999948],[6.63301512739867,46.7798377220067],[6.63301769828578,46.7798348075934],[6.63302019125579,46.7798318657254],[6.63302259300199,46.7798288776405],[6.63302490403604,46.7798258625595],[6.63302712290745,46.7798228105891],[6.6330292382881,46.7798197309833],[6.63303126216564,46.7798166238269],[6.63303319467976,46.7798134797867],[6.63303503635855,46.7798103169857],[6.63303677294002,46.7798071270871],[6.63303840603901,46.7798039090042],[6.63303994763498,46.7798006633707],[6.63304138387895,46.7797974076589],[6.63304272941093,46.7797941249512],[6.63304397079274,46.7797908052694],[6.63304512133929,46.7797874668267],[6.63304616652575,46.7797841188549],[6.63304709384466,46.7797807425972],[6.63304793004895,46.779777366245],[6.6330486618321,46.7797739710361],[6.63304928892292,46.7797705750877],[6.63304981159256,46.7797671602826],[6.63305021678311,46.7797637446478],[6.63305052940872,46.7797603190251],[6.63305073799339,46.7797569025507],[6.63305082857918,46.7797534665747],[6.6330508143331,46.7797500391924],[6.63305070818988,46.779746610612],[6.63305048442801,46.779743190535],[6.63305015597399,46.7797397697187],[6.63304973561467,46.7797363482532],[6.63304919750532,46.7797329440753],[6.63304855470385,46.779729539158],[6.63304780614004,46.7797261516129],[6.63304696593611,46.7797227991101],[6.63304602076903,46.7797194639851],[6.63304497063879,46.779716146238],[6.63304382834047,46.7797128454102],[6.63304258121051,46.779709553176],[6.63304122898599,46.7797062871039],[6.63303978458521,46.7797030385],[6.63303823522961,46.779699806725],[6.63303659422581,46.7796966105411],[6.63303484745981,46.7796934317294],[6.63303300931682,46.7796902703916],[6.63303106501724,46.7796871527785],[6.63302902934067,46.7796840526392],[6.633026902016,46.779680988091],[6.63302468158453,46.7796779497895],[6.63302236950499,46.7796749470791],[6.6330199649864,46.7796719794052],[6.63301746882793,46.7796690467734],[6.63301487942306,46.7796661497214],[6.63301221195611,46.7796632883564],[6.63300931035135,46.7796603171713],[6.63300632895473,46.7796573904461],[6.63300326869692,46.7796544994023],[6.63300011586869,46.779651652179],[6.63299688404782,46.7796488494213],[6.63299358615257,46.7796460824353],[6.6329901963464,46.7796433686086],[6.63298673966673,46.779640690548],[6.63298320386292,46.779638065737],[6.63297960251278,46.7796354948206],[6.63297592071956,46.7796329584763],[6.6329721740395,46.7796304853654],[6.63296834677666,46.7796280561597],[6.63296446688577,46.7796256721547],[6.63296050773928,46.7796233501836],[6.63295649584147,46.7796210816483],[6.63295240414362,46.7796188581218],[6.63294825876378,46.7796166968098],[6.6329440606326,46.7796145889336],[6.6326311358655,46.7794715015494],[6.63240968958697,46.7793759294751],[6.63241674814679,46.779368062906],[6.63240607864268,46.7793634895252],[6.63238694996387,46.7793554378521],[6.6321803169509,46.7792676158048],[6.6321652222586,46.7792612123663],[6.63215936636981,46.7792587418851],[6.63187693548367,46.7791520318191],[6.63185610203257,46.7791441480919],[6.63177227453608,46.779119266004],[6.63173498490015,46.7791084771255],[6.6316422194844,46.7790857806933],[6.63150777012218,46.7790572117897],[6.63145906228679,46.7790481413165],[6.6314355466773,46.7790444663547],[6.63135360100276,46.7790338109985],[6.63127580626676,46.7790257935876],[6.63119837101254,46.7790200276511],[6.63115360888815,46.7790185412534],[6.6311338456187,46.7790178616046],[6.63103895392586,46.7790147612391],[6.63103420278535,46.7790145744087],[6.63102945135677,46.7790144600531],[6.63102469885741,46.7790144170686],[6.63101994433983,46.7790144553316],[6.63101520246082,46.7790145568268],[6.63101045937093,46.7790147390262],[6.63100571506194,46.7790150024789],[6.63100098339966,46.7790153286146],[6.63099626250575,46.7790157360885],[6.63099156770429,46.7790162156749],[6.63098688474214,46.7790167584877],[6.63098221335566,46.7790173820953],[6.63097756726246,46.7790180778098],[6.63097294633071,46.7790188544152],[6.6309683636024,46.7790196949829],[6.63096379258975,46.7790206070122],[6.6309592605879,46.7790215824603],[6.6309547665341,46.7790226388901],[6.63095029709788,46.7790237591858],[6.63094586654886,46.7790249511357],[6.63094148686629,46.7790262153735],[6.63093719841212,46.7790275252807],[6.63093296095619,46.7790288986916],[6.63092876158001,46.7790303443001],[6.63092461413301,46.7790318446338],[6.63092051835983,46.7790334167122],[6.63091647371665,46.7790350435103],[6.63091248074725,46.779036742053],[6.63090853890781,46.7790384953153],[6.63090466165238,46.7790403121778],[6.63090084912097,46.7790421833071],[6.6308970883869,46.779044117946],[6.63089340516348,46.7790461069423],[6.63088977307827,46.7790481501093],[6.63088621929468,46.7790502481884],[6.6308827293041,46.7790524093129],[6.63087931775518,46.7790546160165],[6.63087597092202,46.779056877536],[6.63087270173958,46.7790591840799],[6.63086951085875,46.7790615455359],[6.63086639682123,46.7790639525596],[6.63086336109357,46.7790664139465],[6.63084081924201,46.7790851455394],[6.63067788816889,46.7790173319027],[6.63067627024891,46.7790160696648],[6.63067457319493,46.7790148612241],[6.63067280913457,46.7790136973323],[6.63067096660754,46.7790125960275],[6.63066907066817,46.7790115388187],[6.63066710838147,46.7790105354978],[6.63066507962382,46.7790095942997],[6.63066299810464,46.7790087070855],[6.6306608627611,46.7790078914179],[6.63065868665174,46.7790071292702],[6.63065645844817,46.7790064298963],[6.63065420199348,46.7790058022501],[6.63065189278551,46.7790052280388],[6.63064955679289,46.7790047343508],[6.63064720639867,46.7790042949184],[6.63064481482656,46.7790039364564],[6.63064241032757,46.7790036404965],[6.63063997757741,46.7790034162644],[6.63063754467875,46.7790032551739],[6.63063510976953,46.7790031747823],[6.63063266192513,46.7790031574417],[6.63057310597379,46.7790013864701],[6.63054614009327,46.7790007451901],[6.63041577226514,46.778996943273],[6.63038357270536,46.7789959952764],[6.63036459368164,46.7789954110988],[6.63028815359283,46.7789931601411],[6.63026852005465,46.7789925713089],[6.63011158204498,46.778987860355],[6.63003252311267,46.778985590662],[6.6299585695006,46.7789834471579],[6.62989260060001,46.7789814502689],[6.62985307142329,46.7789802700573],[6.62979312528484,46.7789784058644],[6.62977872598932,46.778978033611],[6.629667601312,46.7789746368924],[6.62960542872054,46.7789727562606],[6.62959862197808,46.7789726184819],[6.62955045199652,46.7789712868278],[6.62934376375137,46.77896595231],[6.62934258498304,46.7789659439462],[6.62928748071679,46.7789642933874],[6.62902975454084,46.7789567973858],[6.62889860191063,46.7789528975673],[6.62887556531506,46.778952194289],[6.6287534453534,46.7789485385243],[6.62871587921771,46.7789474619042],[6.62820526097228,46.778933219813],[6.62819504209722,46.7789335161782],[6.62770127821829,46.778947899762],[6.62760467538028,46.7789280515159],[6.62756796668695,46.7789222130543],[6.62747425376482,46.7789103912123],[6.62746836503354,46.7789101697878],[6.62744101417972,46.7789089853015],[6.62728659236589,46.7789024896067],[6.62727350700051,46.778901856791],[6.62723921972221,46.7789004433686],[6.62721055712544,46.778899430139],[6.62677109565626,46.7788818190784],[6.62657865642284,46.7788781101259],[6.62652734372271,46.7788768454163],[6.62648820787657,46.7788756673878],[6.62646190340646,46.7788745801644],[6.62643454172471,46.7788741157373],[6.62623110309886,46.7788704179203],[6.6261351615354,46.7788674855413],[6.62605178187235,46.7788651823098],[6.62549258336437,46.7788509416062],[6.62507371832242,46.7788395885561],[6.62475355759392,46.7788302873825],[6.62468824030282,46.778828562274],[6.62441441750745,46.778820490736],[6.62412730044512,46.7788082753233],[6.62389200182479,46.778798498235],[6.62355303402438,46.7787860010355],[6.62321316802187,46.7787722368433],[6.62286661565813,46.7787590535982],[6.62280314406255,46.778756530734],[6.62269372715543,46.7787527792447],[6.62232044422611,46.7787407527267],[6.62186562286652,46.7787258915938],[6.62159179885028,46.7787179033154],[6.62042704415747,46.7786812164578],[6.62023294078574,46.778675056328],[6.61960089331363,46.7786551362481],[6.61952022547703,46.7786295485222],[6.61857353508478,46.7785563558565],[6.61766760111022,46.7784641071715],[6.61743194025936,46.7784096045391],[6.61743307567622,46.7784124014358],[6.6174310737251,46.7784149061513],[6.61738890926854,46.7784406009906],[6.61712174265938,46.7785285464754],[6.617199939006,46.7786130414583],[6.61727683674904,46.7786968077532],[6.61729680201862,46.7787185420182],[6.61735412104994,46.7787810270136],[6.61737704901939,46.7788060210059],[6.61756704253095,46.7790129460199],[6.61829610902222,46.7798074060541],[6.61832522115602,46.7798391012347],[6.61827778203087,46.7798757332586],[6.6182065324475,46.7799366632594],[6.61806576191196,46.7800653720229],[6.6179296335272,46.780198702586],[6.61779713626794,46.7803343976047],[6.61764272440655,46.7804987213273],[6.61760010089232,46.7805372770813],[6.61747221324644,46.7806367515337],[6.6174356348243,46.7806652747821],[6.6173968585293,46.7806920722061],[6.61757869821843,46.7807125421594],[6.61773609664961,46.7807302275726],[6.61875435379788,46.7808445129956],[6.61877500936938,46.7808468204896],[6.6199436123675,46.7809779187047],[6.62019775337789,46.7810064604469],[6.62117300991847,46.7811159176976],[6.62117300917989,46.7811159193753],[6.62117301301963,46.7811159198063],[6.6211593139056,46.7811470372795],[6.61994085200934,46.7823736211077],[6.61991093005971,46.7824036325754],[6.61949159590171,46.7828257702863],[6.61953965587018,46.782894662783],[6.62041257392017,46.7829928659547],[6.62076556048542,46.7830325506248],[6.6209102671052,46.7830488292466],[6.62155058061441,46.7831208502619],[6.62225189978743,46.7831997272221],[6.62231896835099,46.7832072240362],[6.62231896780317,46.783207225725],[6.62231897135676,46.7832072261222],[6.62231457501582,46.7832207786132],[6.62229380924046,46.7832429397521],[6.62231608536606,46.7832851983972],[6.62233203275696,46.7832870215292],[6.62238667524991,46.7832935297849],[6.62238667388047,46.7832935312127],[6.62238667771521,46.7832935316694],[6.6221519530631,46.7835382506513],[6.62204417082277,46.7836505581163],[6.62153053516853,46.7841860056728],[6.62192480444758,46.7843189991651],[6.62197340514838,46.7843353598833],[6.62202917118065,46.784354200778],[6.62207777194493,46.7843705614517],[6.62207933513572,46.7843711123976],[6.62210213644768,46.784378832199],[6.6222332141099,46.7844230408354],[6.62274124557868,46.784594000025],[6.62327208055646,46.7847727664666],[6.62381386027413,46.7849554768402],[6.62434208065123,46.7851343994893],[6.62487299994317,46.7853134828529],[6.62526378407723,46.7854452985393],[6.62550141393906,46.7855254551489],[6.6257673069643,46.785615141438],[6.6257673064051,46.7856151424029],[6.62576730952373,46.7856151434548],[6.62538783164383,46.7862699509805],[6.62525362076794,46.7865018988663],[6.62519283534817,46.7865809897011],[6.62482184828459,46.7869591410271],[6.62467353139203,46.7871103844309],[6.62395972502805,46.7878388170252],[6.62378546340914,46.7880165016117],[6.62335046293642,46.7884604014384],[6.62326522228727,46.7884676185776],[6.6233455395161,46.7885172184202],[6.62410240582572,46.788942824758],[6.62459934931466,46.7892265949549],[6.62490342479048,46.7894029254336],[6.62499482953454,46.7894559336656],[6.62549987730217,46.7897643050886],[6.62560738310757,46.7898299450291],[6.62569646959256,46.7898843254065],[6.62614687431488,46.7901592593849],[6.62700161335935,46.7906725336501],[6.62793073595102,46.7911964053971],[6.62806970329408,46.7912747577454],[6.6280697030066,46.7912747581525],[6.62806970582222,46.79127475974],[6.6280240688793,46.791339385773],[6.62795213379439,46.7914542916062],[6.62819299676636,46.7915241909475],[6.62819299886849,46.7915241928172]]]},
			"properties":{"actionsPolygon": [{ "name":"tuer le boss"},{"name":"percer les tueaux"}],"nomsquart":"Cheminet","character":{
				"name":"Mafioso"},"nbActions":8, "influence":"80","ActionPoints": points }}


		var secteur2 = {"type":"Feature","options":{"color":"#ff0000"},"geometry":{"type":"Polygon","coordinates":[[[6.63792998352593,46.7403607999707],[6.6379281646547,46.7403785221911],[6.63783916606001,46.7404764926929],[6.63783916599546,46.7404764927364],[6.63752639413963,46.7406014978598],[6.63730034456969,46.740640840338],[6.63709940386696,46.7405844622054],[6.63709940374548,46.7405844620515],[6.63709940358242,46.7405844620058],[6.6370362138837,46.7405044033223],[6.63703277652579,46.7404085169593],[6.63703233006617,46.740396064654],[6.63739349427323,46.739973544817],[6.63740534670635,46.7399228977296],[6.63742172097901,46.739852927367],[6.63741881346099,46.7397140993814],[6.63727427452398,46.7395696875072],[6.63714591861297,46.7395249746534],[6.63696817353866,46.7395281325215],[6.63681626995453,46.7395621484638],[6.63677521717712,46.7395509743321],[6.63673090704445,46.7395125197749],[6.63673090682443,46.7395125195318],[6.63671335356888,46.7394731051981],[6.63669811195975,46.7394388816374],[6.63672027729294,46.7393130959722],[6.63679701701633,46.7388775997427],[6.6367970124909,46.7388775998663],[6.63674782809184,46.7388812386729],[6.63669533898802,46.738880662455],[6.63668435760757,46.7388806777734],[6.63570192377327,46.7389075146658],[6.63535002513529,46.7389171249194],[6.63534938016008,46.7389178911723],[6.63528434066426,46.7389314664679],[6.63518291804509,46.7389516041964],[6.63513631214558,46.7389408403179],[6.63510169693112,46.7389024558094],[6.63490593877733,46.7388573231701],[6.63464285451929,46.7388340327462],[6.63451729996823,46.7387677200872],[6.63409107681581,46.738669449835],[6.63404719708611,46.738661100894],[6.63399342598139,46.7386552607338],[6.63390146937882,46.7386724055218],[6.63386670245134,46.7386579297775],[6.63363960729748,46.7386664630263],[6.63407895408996,46.7399413309711],[6.63434688760401,46.7407187772522],[6.63430914568873,46.7408206330549],[6.634595868127,46.7414536113625],[6.63527113993766,46.742944297842],[6.63544234341924,46.743322224656],[6.63541185218548,46.7433268367739],[6.63541659559282,46.7433376063333],[6.63502555775085,46.743388115201],[6.63489186791782,46.7434054884556],[6.63398175248182,46.7435431442634],[6.63398684527537,46.743560922526],[6.63380523883714,46.7435850899517],[6.6331168404898,46.7436739556245],[6.63123949718898,46.7439578647618],[6.6313635303764,46.7446546475961],[6.63158556951762,46.7459019597639],[6.63019191025036,46.7461318354043],[6.63043008937117,46.7463040251676],[6.63063136494916,46.7464550909697],[6.6307945486121,46.746623383613],[6.63114325203326,46.747004935298],[6.63127719146086,46.7471486229968],[6.63161394712979,46.7475952013394],[6.63154585801495,46.7476155231224],[6.63152593000695,46.7476584318074],[6.63151463572088,46.7476663983646],[6.63151237189843,46.7476880941878],[6.6309363221252,46.7480973066433],[6.63005870797653,46.7487213872684],[6.63006591224222,46.7487397566081],[6.63012628603178,46.748780241268],[6.62836021238618,46.7500022367018],[6.62858750766159,46.7502181629043],[6.62867193396836,46.7505900258805],[6.62882928180667,46.7506394344401],[6.62935233613175,46.7506069310485],[6.62936435888099,46.750616879047],[6.62939395919076,46.7506145308992],[6.62945381522913,46.7506908978693],[6.62967981168112,46.7508778927819],[6.62985504055804,46.7509063035248],[6.63022804517739,46.7507776534124],[6.63027744501166,46.7507846184335],[6.63038765882461,46.750726743296],[6.6304156540699,46.7507555309451],[6.63041522010487,46.7509562637701],[6.62977891687911,46.7518494309319],[6.63015387704673,46.7520434707825],[6.63038423736156,46.7521338403777],[6.63080289373041,46.7522413048606],[6.63107563713624,46.7523377307798],[6.63100682918832,46.7524199072219],[6.63081344988962,46.7524389219527],[6.63069306388643,46.7524440421562],[6.63040777724203,46.7523880442045],[6.63029844971285,46.7523697089564],[6.62999157733866,46.7523174431572],[6.62972138495218,46.7522874589131],[6.62949678743552,46.7522456441021],[6.62929245910118,46.752189363303],[6.62910818253418,46.7521410235246],[6.62863405398425,46.7520509559383],[6.628547032416,46.752045158213],[6.62831018963515,46.752120457692],[6.62810598066808,46.75234045675],[6.62805568209952,46.7523946442588],[6.62808332223774,46.7524489375637],[6.62810399047433,46.7524895354448],[6.62821996759538,46.7525408271607],[6.6284209319302,46.7525787215664],[6.62863343864334,46.7526187918429],[6.62888738726122,46.7526540801839],[6.62896297333028,46.752664583356],[6.62906827369937,46.752674445604],[6.62961046822839,46.7527252248122],[6.62975656270214,46.7527461032124],[6.63000855243538,46.7527821149222],[6.63035807869047,46.7528913755711],[6.63063847455413,46.7530109404639],[6.63108066628202,46.7532224724301],[6.63185745012273,46.7535940552625],[6.63185744991279,46.7535940554779],[6.63185745024493,46.7535940556367],[6.63182448380355,46.7536278717982],[6.63180278824872,46.7536501259912],[6.63179151668015,46.7536616880552],[6.63204788667426,46.7537866567232],[6.63227090128735,46.7538775811586],[6.63258634562913,46.754006188153],[6.6330005172346,46.754160967416],[6.63324085967557,46.7542376918252],[6.63326024263175,46.7542428692593],[6.63352141275544,46.7543126305166],[6.63350505701655,46.7543823237099],[6.6335493236243,46.754384460849],[6.63378443456901,46.7543958112058],[6.63407969125783,46.7544428217465],[6.63425504072072,46.7544707402363],[6.63431453617426,46.7544856527052],[6.63449693547433,46.7545313702793],[6.63449338350092,46.754555558475],[6.63448629908459,46.7546038029493],[6.63447292908906,46.7546953237966],[6.6344724486933,46.754698612257],[6.63447145497598,46.7547053980499],[6.63445889377205,46.7547911750534],[6.63444883301914,46.7548601028959],[6.63444839980937,46.7548629584804],[6.63444592934692,46.7548792438605],[6.63443174780284,46.7548782967168],[6.63418689352261,46.7548619435826],[6.63393457479095,46.7548944374882],[6.63370690072104,46.7549754194194],[6.63370468714594,46.7549762067678],[6.63351660095305,46.755098483544],[6.63338886872773,46.7552549205904],[6.63332912145161,46.7554690518649],[6.63350231572809,46.7557563463078],[6.63361273556775,46.7558667300379],[6.63368738110135,46.7559413505535],[6.63402110215548,46.7561553810008],[6.6346721995822,46.7564881968029],[6.63475258257821,46.7565292849274],[6.63518576636484,46.7567538186937],[6.63510413214766,46.7568473412231],[6.63501065031658,46.7569540940179],[6.63498095248633,46.7569881592361],[6.63491090561248,46.7570682693805],[6.63489386045313,46.7570877603267],[6.63484076004545,46.7571484025599],[6.63482661111708,46.7571645612446],[6.63480398808604,46.7571903897452],[6.63479771433424,46.7571975524836],[6.63476841785916,46.7572309912437],[6.63459059686232,46.7574343068252],[6.63244864279219,46.7598831912718],[6.63232783392855,46.7600213036581],[6.63232783376778,46.7600213037229],[6.63213031193567,46.7598396378925],[6.63182089431253,46.759555055845],[6.631614156116,46.7593684767511],[6.63160197686929,46.7593574850733],[6.63149552401882,46.7594118767662],[6.63025789974859,46.7600450599225],[6.62994274973205,46.7602065972311],[6.62986372639078,46.760247102234],[6.62979633142219,46.7602816495031],[6.62952324165386,46.7604216372483],[6.62950823000688,46.7604298396549],[6.62950146354333,46.760433537018],[6.62944949519108,46.7604618967204],[6.62940366168242,46.7604869086584],[6.62937673831745,46.7605016528106],[6.62963542193664,46.7607357640912],[6.63001173366884,46.7610783903078],[6.63037982340454,46.7614207214027],[6.63048076742623,46.7615146007854],[6.63095603341269,46.7619547215969],[6.63157956171617,46.7625389256397],[6.63220771369978,46.7631212694923],[6.63251078645076,46.763417580085],[6.63282054699603,46.7636958551616],[6.63295036725193,46.763812550288],[6.63306146005179,46.7639122905843],[6.63307762798397,46.7638903646294],[6.63314618385685,46.7637969312372],[6.63316195485176,46.7637753626558],[6.63324187863071,46.7636658169161],[6.63353934377594,46.7632608510567],[6.63411075625992,46.7625520455505],[6.63447661293179,46.7620547215934],[6.63447968638349,46.7620505148891],[6.63449121444616,46.7620344035984],[6.63449947434095,46.7620228572784],[6.63450295025889,46.7620180236297],[6.63484521648503,46.7615483298525],[6.63502089363731,46.761311445719],[6.63504787915738,46.7612751123891],[6.63505202002073,46.761269563581],[6.63517678037008,46.761277909567],[6.63529242657799,46.7612565947396],[6.63538325253869,46.7611966915341],[6.63569036298117,46.7607661498816],[6.63652770373893,46.7615438519787],[6.63770852534196,46.7626405247935],[6.63877744200703,46.76173880827],[6.63912578285461,46.7614304416798],[6.63956054993015,46.7609787447101],[6.63993027109959,46.7605874031325],[6.64012776995034,46.7604132755436],[6.64015085018536,46.7603928361223],[6.64021802786822,46.7603382514384],[6.64033409992899,46.760243797467],[6.64036894807181,46.7602154344244],[6.64048554821244,46.7601206238094],[6.64053603170666,46.7600795060362],[6.64121987343143,46.7596107442699],[6.64134843459174,46.759524823499],[6.64160738018251,46.759351761615],[6.64162152558994,46.7593423248219],[6.641693819431,46.7592815282918],[6.64192917569467,46.7590835927164],[6.64194574418563,46.7590696748453],[6.64292943855289,46.758238572743],[6.64293274258525,46.758236436315],[6.64300092498965,46.7581400262385],[6.64298010334823,46.7580608963198],[6.64290907912328,46.7579952701328],[6.64293330177255,46.7579859935575],[6.64297969002051,46.7579682353635],[6.64304914704867,46.7579416421864],[6.64307679190733,46.7579310398503],[6.64299307220982,46.7578438680755],[6.64279418054063,46.757656488982],[6.64262662160195,46.7575235015995],[6.64181968720526,46.7569649313179],[6.64142097154284,46.756688930162],[6.6412112054197,46.7565437224729],[6.64104100211567,46.756425899245],[6.64038050101025,46.7559723068168],[6.6396888454602,46.7554973068661],[6.63962580435946,46.7554516876747],[6.63943825882376,46.7553030875743],[6.63943213696716,46.7552982359135],[6.63930426341864,46.7551169252401],[6.63932360885627,46.755109000539],[6.63921131556284,46.7549918780897],[6.63920099965293,46.7549814239562],[6.63920868691433,46.7549467448487],[6.63920912241549,46.7548821570642],[6.63922186067065,46.7545707166673],[6.63922824239565,46.7545363660804],[6.63925358396872,46.7543999260454],[6.63936517542687,46.754068667683],[6.63937955523556,46.754025768148],[6.63947592907536,46.7538115413939],[6.63950421556948,46.7537486670059],[6.63955497132941,46.7535917737672],[6.63964622689956,46.7533605875847],[6.63986182717837,46.7529261550704],[6.63988833314551,46.7528138172966],[6.63992607357772,46.7526538479589],[6.6400298718729,46.7523621167307],[6.64009967790771,46.7520060061444],[6.64030953203976,46.7514682482192],[6.64034457011486,46.7513784544652],[6.64063360893537,46.7511276921353],[6.64069066715421,46.7509248727796],[6.64067316015806,46.7506233589994],[6.64070280302532,46.7505766166761],[6.64071078722082,46.7505449725977],[6.64071943272775,46.7505106937717],[6.64072419872842,46.7504743386647],[6.64082272638331,46.7504389362815],[6.64082272606249,46.7504389363671],[6.64077346249565,46.7504566374634],[6.64077927668301,46.7503716124484],[6.64081113326014,46.7502576048235],[6.64087588284737,46.7501318897542],[6.64095257433454,46.7499783707638],[6.64099512253649,46.7498732359397],[6.64101072999876,46.7498241732774],[6.64102169487148,46.7497951930759],[6.64106450637609,46.7496678400691],[6.64109530818437,46.7495816854434],[6.64110403702352,46.7495410758173],[6.64116692633484,46.7493756034565],[6.64128052324365,46.7490991968398],[6.64129235669995,46.7490663364364],[6.64131859207711,46.7490198399464],[6.64137694187624,46.7489328433854],[6.64142369913585,46.7488005340807],[6.64150753463969,46.7485673155689],[6.64151545512888,46.7484676991471],[6.64146133299829,46.7481879968811],[6.64144819705757,46.7481375058499],[6.64143600179462,46.7480701578303],[6.64142626976357,46.7480067891018],[6.64139643683803,46.7478526107361],[6.64137111818559,46.747721762902],[6.64136118123011,46.7476882151685],[6.64131482565732,46.7475662386742],[6.6412242792975,46.7473034002655],[6.64121699843489,46.7472648016735],[6.64118334287776,46.7471690202133],[6.64116949458343,46.747126732312],[6.64115044351162,46.7470044969548],[6.64115281499593,46.7468938273324],[6.64116579175136,46.7467306865369],[6.6411566645023,46.746658583084],[6.64113390407679,46.7466056895668],[6.64111689802519,46.7465557150097],[6.64110676719744,46.7465204609535],[6.64095163337407,46.7462412475316],[6.64086274087121,46.7459465386774],[6.64087668123174,46.7457937445852],[6.64081079471183,46.7451754050584],[6.64078839760568,46.7450460449625],[6.64079345924167,46.7450127107366],[6.64073748297841,46.7444873637431],[6.64073727536598,46.7444639043884],[6.64073679440738,46.7444094786018],[6.64073089614487,46.7442862128202],[6.64073538810843,46.7442503396862],[6.64073420164947,46.7441160774602],[6.64081445407629,46.7440351211751],[6.64089620314682,46.7439328571965],[6.64103795440033,46.7437702756953],[6.64105058367772,46.7437445816546],[6.64107742440111,46.7436641117147],[6.64112533481238,46.7434200717643],[6.64103039461245,46.7430532719807],[6.64097370417851,46.7428061806685],[6.64096622656526,46.7427735887556],[6.64093079457426,46.742612402965],[6.6408646154385,46.7424950823756],[6.64075537201796,46.7424025918282],[6.64069544117828,46.7423518516786],[6.6404708335453,46.742231712317],[6.64031190038167,46.742155385107],[6.64023404076343,46.7421179931673],[6.64015509194261,46.7420800781212],[6.64001072715671,46.741962591735],[6.63997446118368,46.7419330778774],[6.63988540966528,46.7417170006067],[6.63991245372911,46.7416669926646],[6.63990444885257,46.7416243856763],[6.63988032496744,46.7415728068909],[6.63979574983343,46.7413919778634],[6.63971785208491,46.741346920009],[6.63943648810499,46.7411841715586],[6.63943648797886,46.7411841714478],[6.63906080594259,46.7408485965105],[6.63878217807914,46.740692270519],[6.63859340992287,46.7404241256309],[6.63842479420483,46.7401472154328],[6.63835239104678,46.74012256629],[6.6382084083218,46.740073548318],[6.6381698067869,46.7400772039343],[6.63803242316247,46.740090214602],[6.63794882228243,46.7401772479386],[6.63792998352593,46.7403607999707]]]},
			"properties":{"actionsPolygon": [{ "name":"faire caca"},{"name":"comme ma bite?"} ],"nomsquart":"Centre","character":{
				"name":"Mafioso2"},"nbActions":8, "influence":"10","ActionPoints": points2 }}
	

		var sectors = [secteur,secteur2];
		var all = [points, points2, secteur, secteur2];

		var markerIcon = {
			type : "extraMarker",
       		icon: "fa-coffee",
    		markerColor: 'green',
    		prefix: "fa",
    		layer: 'cars',
  			shape: 'square',
    		imgHeight: 30,
    		imgWidth : 30        
		}
		var playerIcon = {
			type : "extraMarker",
       		iconImg: "img/dick.png",
    		markerColor: 'orange',
    		prefix: "fa",
  			shape: 'square',
    		imgHeight: 30,
    		imgWidth : 30        
		}
		var fontaineIcon = {
			type : "extraMarker",
    		markerColor: 'red',
    		icon: "fa-star",
    		prefix: "fa",
  			shape: 'square',
    		imgHeight: 30,
    		imgWidth : 30        
		}




// function isClickInCircle(latlng,  sectors, circles){
	// 	var totalCircles = 0;
	// 	var isInCircle = false;
	// 	//total circles
	// 	for (var i = sectors.length - 1; i >= 0; i--) {
	// 		totalCircles = totalCircles+ sectors[i].properties.ActionPoints.length;
	// 	};		
	// 	console.log(latlng)
	// 	// check what circles is the marker in
	// 	for (i = 1; i < totalCircles; i++) {
		    
	// 		isInCircle = geolib.isPointInCircle(
	// 			{latitude: latlng.lat, longitude: latlng.lng},
	// 			{latitude: circles["circle"+i].latlngs.lat, longitude:circles["circle"+i].latlngs.lng},
	// 			circles["circle"+i].radius
	// 		)
	// 		if (isInCircle) {
	// 			console.log(marker.properties.type + " is in circle"+i)
	// 		};		
	// 	};

	// }
app.directive("stateMap", [function() {
        return{
            replace: false,
            restrict: "E",
            template: "<div></div>",
            link: function(scope, element, attrs) {
                var map = new L.map(element[0], {center: [18.53, -72.33], zoom: 12});
                var osmCopyright = "Map data &copy; 2012 OpenStreetMap contributors";
                var osmTile = "http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png";
                var osmLayer = new L.TileLayer(osmTile, {minZoom: 8, maxZoom: 12, attribution: osmCopyright});
                map.setView(new L.LatLng(18.53, -72.33), 9);
                map.addLayer(osmLayer);

                var haiti = {"type": "FeatureCollection", "features": [
                        {"type": "Feature", "properties": {"name": "Haiti"}, "geometry": {"type": "Polygon", "coordinates": [[[-73.189791, 19.915684], [-72.579673, 19.871501], [-71.712361, 19.714456], [-71.624873, 19.169838], [-71.701303, 18.785417], [-71.945112, 18.6169], [-71.687738, 18.31666], [-71.708305, 18.044997], [-72.372476, 18.214961], [-72.844411, 18.145611], [-73.454555, 18.217906], [-73.922433, 18.030993], [-74.458034, 18.34255], [-74.369925, 18.664908], [-73.449542, 18.526053], [-72.694937, 18.445799], [-72.334882, 18.668422], [-72.79165, 19.101625], [-72.784105, 19.483591], [-73.415022, 19.639551], [-73.189791, 19.915684]]]}, "id": "HTI"}
                    ]};
                L.geoJson(haiti, {
                    style: function(feature) {
                        return {opacity: 0, fillOpacity: 0.5, fillColor: "#0f0"};
                    }
                }).addTo(map);
            }
        }
    }]);

